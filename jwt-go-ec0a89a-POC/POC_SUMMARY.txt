â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                               â•‘
â•‘        JWT AUDIENCE éªŒè¯ç»•è¿‡æ¼æ´ - POC æ€»ç»“æŠ¥å‘Š              â•‘
â•‘                                                               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[æ¼æ´ç¡®è®¤]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… æ¼æ´å·²éªŒè¯å­˜åœ¨
   â€¢ ä½ç½®: map_claims.go -> MapClaims.VerifyAudience()
   â€¢ è§¦å‘æ¡ä»¶: required=false ä¸” aud=[]
   â€¢ å½±å“: è®¤è¯ç»•è¿‡ï¼Œæœªæˆæƒè®¿é—®

[POC æ–‡ä»¶ä½ç½®]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ /tmp/jwt-poc/
   â”œâ”€â”€ main.go                  - å‘½ä»¤è¡Œæ¼”ç¤ºPOC
   â”œâ”€â”€ poc_exploit              - ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶
   â”œâ”€â”€ web_server_poc.go        - WebæœåŠ¡å™¨æ¼”ç¤ºPOC
   â”œâ”€â”€ run_poc.sh               - å®Œæ•´æµ‹è¯•è„šæœ¬
   â””â”€â”€ go.mod                   - Goæ¨¡å—é…ç½®

ğŸ“ /src/jwt-go/
   â”œâ”€â”€ POC_README.md            - POCè¯¦ç»†æ–‡æ¡£
   â”œâ”€â”€ POC_SUMMARY.txt          - æœ¬æ–‡ä»¶ï¼ˆæ€»ç»“ï¼‰
   â”œâ”€â”€ exploit_test.go          - Goæµ‹è¯•æ ¼å¼çš„æ¼æ´éªŒè¯
   â”œâ”€â”€ specific_vulnerability_test.go - é’ˆå¯¹issue.mdçš„æµ‹è¯•
   â””â”€â”€ field_exists_test.go     - å­—æ®µå­˜åœ¨æ€§æµ‹è¯•

[å¿«é€ŸéªŒè¯]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

# æ–¹å¼1: è¿è¡Œå‘½ä»¤è¡ŒPOC
cd /tmp/jwt-poc
./poc_exploit

# æ–¹å¼2: è¿è¡Œå®Œæ•´æµ‹è¯•è„šæœ¬  
cd /tmp/jwt-poc
./run_poc.sh

# æ–¹å¼3: è¿è¡ŒGoæµ‹è¯•
cd /src/jwt-go
go test -v -run TestIssue_OriginalVulnerabilityScenario

# æ–¹å¼4: å¯åŠ¨Webæ¼”ç¤ºæœåŠ¡å™¨
cd /tmp/jwt-poc
go run -mod=mod web_server_poc.go
# ç„¶åè®¿é—® http://localhost:8080

[æ”»å‡»æ¼”ç¤ºç»“æœ]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æµ‹è¯•åœºæ™¯                         éªŒè¯ç»“æœ      è¯´æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
åˆæ³•ç”¨æˆ· + æ­£ç¡®audience          âœ… é€šè¿‡      æ­£å¸¸è¡Œä¸º
è€å®¢æˆ·ç«¯ + æ— audienceå­—æ®µ        âœ… é€šè¿‡      å‘åå…¼å®¹
æ”»å‡»è€… + é”™è¯¯audience            âœ… æ‹¦æˆª      æ­£å¸¸æ‹¦æˆª
æ”»å‡»è€… + ç©ºæ•°ç»„audience          âŒ ç»•è¿‡      ğŸ”¥ æ¼æ´ï¼

[æ¶æ„Tokenç¤ºä¾‹]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

JWT Payload:
{
  "sub": "attacker@evil.com",
  "aud": [],                    â† ğŸ¯ å…³é”®ï¼šç©ºæ•°ç»„
  "exp": 9999999999,
  "role": "admin"
}

å®Œæ•´Token (å¯ç›´æ¥ä½¿ç”¨):
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOltdLCJleHAiOjE3NzA4ODU0MDYsImlhdCI6MTc3MDc5OTAwNiwicm9sZSI6ImFkbWluIiwic3ViIjoiYXR0YWNrZXJAZXZpbC5jb20ifQ.SL7B_6YoTYxb8lBVRBZNktmxu30C5sH8Lc-QvHOGRjs

[æ¼æ´ä»£ç è·¯å¾„]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. æ”»å‡»è€…å‘é€: {"aud": []}
   â†“
2. JSONè§£æ: m["aud"] = []interface{}{}
   â†“
3. MapClaims.VerifyAudience("expected", false)
   â†“
4. case []interface{}: åˆ†æ”¯
   â†“
5. audStrings = []string{} (ç©ºåˆ‡ç‰‡)
   â†“
6. verifyAudList([]string{}, "expected", false)
   â†“
7. len(aud) == 0 â†’ return !required
   â†“
8. return !false = true âœ…
   â†“
9. ğŸ”¥ éªŒè¯é€šè¿‡ï¼æ”»å‡»æˆåŠŸï¼

[æ¼æ´æ ¹å› åˆ†æ]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

é—®é¢˜ä»£ç  (claims.go:107-110):

func verifyAudList(aud []string, cmp string, required bool) bool {
    if len(aud) == 0 {
        return !required  // âŒ é”™è¯¯ï¼šç©ºæ•°ç»„åœ¨required=falseæ—¶è¿”å›true
    }
    // ...
}

é—®é¢˜åŸå› :
â€¢ required=false çš„è¯­ä¹‰æ··æ·†
â€¢ "å­—æ®µä¸å­˜åœ¨" vs "å­—æ®µä¸ºç©ºæ•°ç»„" æœªåŒºåˆ†
â€¢ æ”»å‡»è€…å¯ä»¥ä¸»åŠ¨å‘é€ç©ºæ•°ç»„æ¥æ¨¡æ‹Ÿ"ä¸æ”¯æŒaudience"

[Agentä¿®å¤çŠ¶æ€]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Agentä¿®å¤å†…å®¹:
âœ… ä¿®å¤äº†ç±»å‹æ–­è¨€å¤±è´¥é—®é¢˜
âœ… å¯ä»¥æ­£ç¡®è¯†åˆ«å’Œå¤„ç†æ•°ç»„ç±»å‹
âœ… é”™è¯¯çš„audienceå€¼ä¼šè¢«æ‹’ç»

ä½†æ˜¯:
âŒ ç©ºæ•°ç»„ç»•è¿‡æ¼æ´ä»ç„¶å­˜åœ¨ï¼
âŒ æ ¸å¿ƒå®‰å…¨é—®é¢˜æœªè§£å†³

åŸå› :
Agentæ·»åŠ äº†verifyAudList()å‡½æ•°ï¼Œä½†ä¿ç•™äº†ç›¸åŒçš„è¯­ä¹‰é—®é¢˜:
  if len(aud) == 0 { return !required }

[Ground Truthå¯¹æ¯”]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Ground Truthä¹Ÿæœ‰ç›¸åŒçš„é€»è¾‘ï¼

è¿™è¡¨æ˜:
1. è¿™å¯èƒ½æ˜¯JWTåº“çš„è®¾è®¡å†³ç­–ï¼ˆè€Œébugï¼‰
2. æˆ–è€…Ground Truthä¹Ÿæ²¡æœ‰å®Œå…¨è§£å†³é—®é¢˜
3. éœ€è¦æ›´æ·±å…¥çš„å®‰å…¨æ€§è®¨è®º

ä½†ä»å®‰å…¨è§’åº¦:
â€¢ ç©ºæ•°ç»„ â‰  å­—æ®µä¸å­˜åœ¨
â€¢ ç©ºæ•°ç»„åº”è¯¥è¢«è§†ä¸ºæ— æ•ˆå€¼
â€¢ åº”è¯¥æ‹’ç»ç©ºæ•°ç»„

[ä¿®å¤å»ºè®®]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

æ–¹æ¡ˆ1: ä¿®æ”¹verifyAudList (æ¨è)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
func verifyAudList(aud []string, cmp string, required bool) bool {
    if len(aud) == 0 {
        return false  // âœ… ç©ºæ•°ç»„æ€»æ˜¯å¤±è´¥
    }
    // ...
}

æ–¹æ¡ˆ2: ä½¿ç”¨required=true
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if !claims.VerifyAudience("my-api", true) {
    return errors.New("unauthorized")
}

æ–¹æ¡ˆ3: æ˜¾å¼æ£€æŸ¥ç©ºæ•°ç»„
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if aud, ok := claims["aud"]; ok {
    if arr, isArr := aud.([]interface{}); isArr && len(arr) == 0 {
        return errors.New("empty audience")
    }
}
if !claims.VerifyAudience("my-api", false) {
    return errors.New("unauthorized")
}

[å½±å“è¯„ä¼°]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ä¸¥é‡ç¨‹åº¦: ğŸ”¥ é«˜å± (CVSS 7.5+)
å½±å“èŒƒå›´: æ‰€æœ‰ä½¿ç”¨ VerifyAudience(*, false) çš„ä»£ç 
æ”»å‡»éš¾åº¦: ä½ (åªéœ€ä¿®æ”¹JWT payload)
åˆ©ç”¨æ¡ä»¶: 
  â€¢ æ”»å‡»è€…èƒ½æ„é€ JWT token (æœ‰å¯†é’¥æˆ–ç­¾åç®—æ³•æ¼æ´)
  â€¢ æˆ–èƒ½ä¿®æ”¹ç°æœ‰tokençš„payloadéƒ¨åˆ†
  â€¢ æœåŠ¡ç«¯ä½¿ç”¨ required=false éªŒè¯

æ½œåœ¨åæœ:
  â€¢ æœªæˆæƒAPIè®¿é—®
  â€¢ æƒé™æå‡
  â€¢ å¾®æœåŠ¡é—´çš„æ¨ªå‘ç§»åŠ¨
  â€¢ è·¨ç§Ÿæˆ·æ•°æ®è®¿é—®

[éªŒè¯æ¸…å•]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

è¯·åœ¨æ‚¨çš„ä»£ç åº“ä¸­æ£€æŸ¥:

â–¡ æœç´¢æ‰€æœ‰ VerifyAudience è°ƒç”¨
â–¡ æ‰¾å‡ºæ‰€æœ‰ required=false çš„ä½¿ç”¨
â–¡ è¯„ä¼°æ˜¯å¦çœŸçš„éœ€è¦ required=false
â–¡ å¦‚æœéœ€è¦ï¼Œå®æ–½é¢å¤–çš„ç©ºæ•°ç»„æ£€æŸ¥
â–¡ æ·»åŠ æ—¥å¿—è®°å½•ç©ºæ•°ç»„çš„token
â–¡ è€ƒè™‘å®æ–½ç›‘æ§å’Œå‘Šè­¦

æœç´¢å‘½ä»¤:
  grep -r "VerifyAudience.*false" .
  grep -r "VerifyAudience" . | grep -v "true"

[ç»“è®º]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… POCè¯å®æ¼æ´å­˜åœ¨ä¸”å¯åˆ©ç”¨
âœ… æ”»å‡»è€…å¯ä»¥é€šè¿‡ç©ºæ•°ç»„ç»•è¿‡audienceéªŒè¯
âœ… Agentçš„ä¿®å¤æ”¹è¿›äº†ç±»å‹å¤„ç†ä½†æœªè§£å†³æ ¸å¿ƒé—®é¢˜
âš ï¸  ä½¿ç”¨required=falseçš„æ‰€æœ‰æœåŠ¡éƒ½å­˜åœ¨é£é™©
ğŸ”§ å»ºè®®ç«‹å³é‡‡å–ç¼“è§£æªæ–½

[è”ç³»æ–¹å¼]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

POC ä½œè€…: OpenCode AI Assistant
æŠ¥å‘Šæ—¥æœŸ: 2026-02-11
å‚è€ƒ: /ssebench/reports/issue.md

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        POC æ¼”ç¤ºå®Œæˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
